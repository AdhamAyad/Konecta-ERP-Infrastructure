apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: prod

resources:
- ../../base
- namespace.yaml

# namePrefix: prod-

labels:
- includeSelectors: true
  pairs:
    environment: production

# Image tags for production environment (use specific versions, not latest)
images:
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/config-server
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/api-gateway
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/authentication-service
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/hr-service
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/inventory-service
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/finance-service
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/user-management-service
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/reporting-service
  newTag: v1.0.0
- name: us-central1-docker.pkg.dev/erp-system-478020/konecta-erp/frontend
  newTag: v1.0.0


# Remove MailHog in production

configMapGenerator:
- literals:
  - ENVIRONMENT=production
  - LOG_LEVEL=WARN
  name: environment-config

generatorOptions:
  disableNameSuffixHash: true
patches:
- patch: |-
    - op: replace
      path: /spec/replicas
      value: 0
  target:
    group: apps
    kind: Deployment
    name: mailhog
    version: v1
- path: patch-replicas.yaml
- path: patch-resources.yaml
- path: patch-hpa.yaml
- path: monitoring-patch.yaml
